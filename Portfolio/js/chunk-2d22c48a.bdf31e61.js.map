{"version":3,"sources":["webpack:///./src/views/Coupons.vue","webpack:///./src/components/CouponsModal.vue","webpack:///./src/components/CouponsModal.vue?797a","webpack:///./src/views/Coupons.vue?86d8"],"names":["class","_createElementVNode","_createVNode","_component_loading","active","$data","_hoisted_1","onClick","$options","_hoisted_2","_hoisted_3","_createElementBlock","_Fragment","item","key","title","percent","_ctx","date","due_date","is_enabled","_hoisted_4","_hoisted_5","_hoisted_6","_component_CouponsModal","ref","coupon","onUpdateCoupon","_component_DelModalVue","onDelItem","_component_Pagination","pages","onChangPage","id","tabindex","role","aria-labelledby","aria-hidden","type","data-bs-dismiss","aria-label","for","_hoisted_7","placeholder","_hoisted_8","_hoisted_9","code","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","true-value","false-value","_hoisted_16","_hoisted_17","_hoisted_18","name","props","Object","default","mixins","modalMixin","data","modal","tempCoupon","watch","this","dateAndTime","Date","toISOString","split","Math","floor","__exports__","components","Pagination","CouponsModal","DelModalVue","coupons","pagination","isNew","isLoading","inject","methods","getCoupons","page","api","$http","get","then","res","success","changPage","openModal","getTime","$refs","showModal","openDelModal","CouponsDelModal","updateCoupon","httpMethods","methodsTxt","sendData","hideModal","$httpMessage","deleteData","delete","mounted","render"],"mappings":"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","file":"js/chunk-2d22c48a.bdf31e61.js","sourcesContent":["<template>\r\n  <loading :active=\"isLoading\"></loading>\r\n  <div class=\"text-end mt-4\">\r\n    <button class=\"btn btn-primary\" @click.prevent=\"openModal(true)\">\r\n      建立新的優惠券\r\n    </button>\r\n  </div>\r\n  <table class=\"table mt-4\">\r\n    <thead>\r\n    <tr>\r\n      <th>名稱</th>\r\n      <th>折扣百分比</th>\r\n      <th>到期日</th>\r\n      <th>是否啟用</th>\r\n      <th>編輯</th>\r\n    </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-for=\"item in coupons\" :key=\"item\">\r\n        <td>{{ item.title }}</td>\r\n        <td>{{ item.percent }}%</td>\r\n        <td>{{ $filters.date(item.due_date) }}</td>\r\n        <td>\r\n          <span class=\"text-success\" v-if=\"item.is_enabled === 1\">啟用</span>\r\n          <span class=\"text-muted\" v-else>未啟用</span>\r\n        </td>\r\n        <td>\r\n          <div class=\"btn-group\">\r\n            <button class=\"btn btn-outline-primary btn-sm\" @click.prevent=\"openModal(false, item)\">編輯</button>\r\n            <button class=\"btn btn-outline-danger btn-sm\" @click.prevent=\"openDelModal(item)\">刪除</button>\r\n          </div>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <CouponsModal ref=\"CouponsModal\" :coupon=\"tempCoupon\" @update-coupon=\"updateCoupon\"></CouponsModal>\r\n  <DelModalVue ref=\"CouponsDelModal\" :item=\"tempCoupon\" @del-item=\"deleteData\"></DelModalVue>\r\n  <Pagination :pages=\"pagination\" @chang-page=\"changPage\"></Pagination>\r\n</template>\r\n<script>\r\nimport Pagination from '../components/Pagination.vue'\r\nimport CouponsModal from '../components/CouponsModal.vue'\r\nimport DelModalVue from '../components/DelModal.vue'\r\nexport default {\r\n  components: {\r\n    Pagination,\r\n    CouponsModal,\r\n    DelModalVue\r\n  },\r\n  data () {\r\n    return {\r\n      coupons: [],\r\n      pagination: {},\r\n      tempCoupon: {\r\n        title: '',\r\n        is_enabled: 0,\r\n        percent: 100,\r\n        code: ''\r\n      },\r\n      isNew: false,\r\n      isLoading: false\r\n    }\r\n  },\r\n  inject: ['emitter'],\r\n  methods: {\r\n    getCoupons (page = 1) {\r\n      this.isLoading = true\r\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`\r\n      this.$http.get(api).then((res) => {\r\n        if (res.data.success) {\r\n          this.coupons = res.data.coupons\r\n          this.pagination = res.data.pagination\r\n          this.isLoading = false\r\n        }\r\n      })\r\n    },\r\n    changPage (page) {\r\n      this.getCoupons(page)\r\n    },\r\n    openModal (isNew, item) {\r\n      this.isNew = isNew\r\n      if (this.isNew) {\r\n        this.tempCoupon = {\r\n          due_date: new Date().getTime() / 1000\r\n        }\r\n      } else {\r\n        this.tempCoupon = { ...item }\r\n      }\r\n      this.$refs.CouponsModal.showModal()\r\n    },\r\n    openDelModal (item) {\r\n      this.tempCoupon = { ...item }\r\n      this.$refs.CouponsDelModal.showModal()\r\n    },\r\n    updateCoupon (tempCoupon) {\r\n      let api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`\r\n      let httpMethods = 'post'\r\n      let methodsTxt = '新增'\r\n      let sendData = tempCoupon\r\n      if (!this.isNew) {\r\n        api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${tempCoupon.id}`\r\n        httpMethods = 'put'\r\n        methodsTxt = '修改'\r\n        sendData = this.tempCoupon\r\n      }\r\n      this.$http[httpMethods](api, { data: sendData }).then((res) => {\r\n        this.$refs.CouponsModal.hideModal()\r\n        if (res.data.success) {\r\n          this.getCoupons()\r\n          this.$httpMessage(res, methodsTxt)\r\n        } else {\r\n          this.$httpMessage(res, methodsTxt)\r\n        }\r\n      })\r\n    },\r\n    deleteData () {\r\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`\r\n      this.$http.delete(api).then((res) => {\r\n        if (res.data.success) {\r\n          this.getCoupons()\r\n          this.$httpMessage(res, '刪除')\r\n        } else {\r\n          this.$httpMessage(res, '刪除')\r\n        }\r\n        this.$refs.CouponsDelModal.hideModal()\r\n      })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getCoupons()\r\n  }\r\n}\r\n</script>\r\n","<template>\r\n  <div class=\"modal fade\" id=\"couponModal\" tabindex=\"-1\" role=\"dialog\"\r\n      aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\" ref=\"modal\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">優惠碼資訊</h5>\r\n          <button type=\"button\" class=\"btn-close\"\r\n                  data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"mb-3\">\r\n            <label for=\"title\">標題</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"title\" v-model=\"tempCoupon.title\"\r\n                  placeholder=\"請輸入標題\">\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"coupon_code\">優惠碼</label>\r\n            <input type=\"text\" class=\"form-control\" id=\"coupon_code\" v-model=\"tempCoupon.code\"\r\n                  placeholder=\"請輸入優惠碼\">\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"due_date\">到期日</label>\r\n            <input type=\"date\" class=\"form-control\" id=\"due_date\"\r\n                  v-model=\"due_date\">\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"price\">折扣百分比</label>\r\n            <input type=\"number\" class=\"form-control\" id=\"price\"\r\n                  v-model.number=\"tempCoupon.percent\" placeholder=\"請輸入折扣百分比\">\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <div class=\"form-check\">\r\n              <input class=\"form-check-input\" type=\"checkbox\"\r\n                    :true-value=\"1\"\r\n                    :false-value=\"0\"\r\n                    v-model=\"tempCoupon.is_enabled\" id=\"is_enabled\">\r\n              <label class=\"form-check-label\" for=\"is_enabled\">\r\n                是否啟用\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button type=\"button\" class=\"btn btn-primary\"\r\n            @click=\"$emit('update-coupon',tempCoupon)\">更新優惠券\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport modalMixin from '../mixins/modalMixin'\r\n\r\nexport default {\r\n  name: 'couponModal',\r\n  props: {\r\n    coupon: {\r\n      type: Object,\r\n      default () {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  mixins: [\r\n    modalMixin\r\n  ],\r\n  data () {\r\n    return {\r\n      modal: {},\r\n      tempCoupon: {},\r\n      due_date: ''\r\n    }\r\n  },\r\n  watch: {\r\n    coupon () {\r\n      this.tempCoupon = this.coupon\r\n      // console.log(this.tempCoupon.due_date)\r\n      const dateAndTime = new Date(this.tempCoupon.due_date * 1000)\r\n        .toISOString().split('T');\r\n      [this.due_date] = dateAndTime\r\n    },\r\n    due_date () {\r\n      this.tempCoupon.due_date = Math.floor(new Date(this.due_date) / 1000)\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./CouponsModal.vue?vue&type=template&id=66400f65\"\nimport script from \"./CouponsModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponsModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\acerk\\\\Desktop\\\\Vue3_Project\\\\shopping\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Coupons.vue?vue&type=template&id=2322d4b8\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\acerk\\\\Desktop\\\\Vue3_Project\\\\shopping\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}